<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clinica Sanar - Gestión de Usuarios</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.23.0/sweetalert2.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body class="d-flex flex-column min-vh-100">

    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid p-3">
            <div class="d-flex justify-content-between align-items-center">
                <a class="navbar-brand" href="#">
                    <img src="../assets/img/LogoSanar.png" alt="Clinica Sanar" class="img-fluid">
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarText">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            
            <div class="collapse navbar-collapse justify-content-between mt-4 mt-xs-0" id="navbarText">
                <ul class="navbar-nav mb-2 mb-lg-0 w-75 d-flex justify-content-center" id="main-nav-list">
                    <li class="nav-item"><a class="nav-link" href="../index.html">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link" href="../nosotros.html">Nosotros</a></li>
                    <li class="nav-item"><a class="nav-link" href="../especialidades.html">Especialidades</a></li>
                    <li class="nav-item"><a class="nav-link" href="../contacto.html">Contacto</a></li>
                    <li class="nav-item d-none" id="nav-admin"><a class="nav-link" href="../admin.html">Admin</a></li>
                    <li class="nav-item d-none" id="nav-logout"><a class="nav-link" href="javascript:logout()">Cerrar Sesión</a></li>
                </ul>
               
                <span class="navbar-text col-xs-6 col-md-3 d-flex justify-content-start justify-content-md-end align-items-center" id="auth-buttons">
                    <a href="../login.html" id="btn-ingresar" class="btn btn-principal">INGRESAR</a>
                    <a href="javascript:solicitarTurno()" id="btn-solicitar-turno" class="btn btn-principal d-none me-3">SOLICITAR TURNO</a>
                    <span id="user-icon" class="d-none me-3" style="font-size: 1.5rem; color: #1B69B4;">
                        <i class="fa-solid fa-user"></i>
                    </span>
                    <div class="dark-mode-btn">
                        <button id="toggle-dark-mode"><i class="fa-solid fa-sun"></i></button>
                    </div>
                </span> 
            </div>
        </div>
    </nav>

    <main class="mt-4">
        <div class="container">
        
            <h3 class="mt-5">Lista de Usuarios (API Externa)</h3>
            <hr>

            <div class="row mb-2">
                <div class="col-sm-12 d-flex justify-content-end">
                    <button type="button" class="btn btn-primary" onclick="nuevoUsuario();">
                        <i class="fa-solid fa-plus"></i> Nuevo Usuario
                    </button>
                </div>
            </div>

            <table class="table table-sm table-bordered table-striped" id="tabla-usuarios">
                <thead>
                    <tr>
                        <th class="text-center fw-bold">ID</th>
                        <th class="text-center fw-bold">Nombre</th>
                        <th class="text-center fw-bold">Apellido</th>
                        <th class="text-center fw-bold">Usuario</th>
                        <th class="text-center fw-bold">Email</th>
                        <th class="text-center fw-bold">Foto</th>
                        <th class="text-center fw-bold">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="7" class="text-center">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Cargando...</span>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- ✅ Modal corregido con ID correcto -->
        <div class="modal fade" id="modalUsuarios" tabindex="-1">
            <div class="modal-dialog"> 
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Usuario</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>

                    <div class="modal-body">
                        <form id="formUsuario">
                            <input type="hidden" id="id_usuario" class="form-control form-control-sm">

                            <div class="mb-3">
                                <label for="firstName" class="form-label">Nombre: <span class="text-danger">*</span></label>
                                <input type="text" id="firstName" class="form-control form-control-sm" placeholder="Ingrese el nombre">
                            </div>
                            
                            <div class="mb-3">
                                <label for="lastName" class="form-label">Apellido: <span class="text-danger">*</span></label>
                                <input type="text" id="lastName" class="form-control form-control-sm" placeholder="Ingrese el apellido">
                            </div>
                            
                            <div class="mb-3">
                                <label for="username" class="form-label">Usuario: <span class="text-danger">*</span></label>
                                <input type="text" id="username" class="form-control form-control-sm" placeholder="Ingrese el nombre de usuario">
                            </div>

                            <div class="mb-3">
                                <label for="email" class="form-label">Email: <span class="text-danger">*</span></label>
                                <input type="email" id="email" class="form-control form-control-sm" placeholder="correo@ejemplo.com">
                            </div>
                        </form>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">CANCELAR</button>
                        <button type="button" class="btn btn-primary" id="btnGuardarUsuario">GUARDAR</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-dark text-white text-center py-3 mt-auto">
        <p>&copy; 2025 Clínica Sanar | Todos los derechos reservados</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.23.0/sweetalert2.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- ✅ PROTECCIÓN DE RUTA -->
    <script src="../assets/js/auth-guard.js"></script>

    <script src="../assets/js/config.js"></script>
    <script src="../assets/js/main.js"></script>
    <script src="usuarios.js"></script>
    <script src="assets/js/auth-guard.js"></script>
</body>
</html>